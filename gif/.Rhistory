df.d = data.frame(df.d, stringsAsFactors = FALSE)
df.d$color = lapply(df.d$color, function(x) if(is.factor(x)) factor(x) else x)
df.d$color[which(df.d$counts == 1)] = "yellow"
df.d$color[which(df.d$counts == 2)] = "orange"
df.d$color[which(df.d$counts == 3)] = "darkorange"
df.d$color[which(df.d$counts >= 4)] = "red"
streets$color = unlist(df.d$color)
id = i
if(id <= 9){id = paste(0,i, sep = "")}
plot(boundaries, ylim = c(38.79323, 38.99526), xlim = c(-77.11664, -76.90953))
plot(streets, col = streets$color, ylim = c(38.79323, 38.99526), xlim = c(-77.11664, -76.90953), add = TRUE)
text(x = -76.9, y = 38.95, mymonths[i], cex = 4)
unlist(df.d$color)
df.d$color[which(df.d$counts >= 5)] = "darkred"
df.d$color[which(df.d$counts == 4)] = "red"
df.d$color[which(df.d$counts >= 5)] = "darkred"
plot(boundaries, ylim = c(38.79323, 38.99526), xlim = c(-77.11664, -76.90953))
plot(streets, col = streets$color, ylim = c(38.79323, 38.99526), xlim = c(-77.11664, -76.90953), add = TRUE)
text(x = -76.9, y = 38.95, mymonths[i], cex = 4)
dev.off()
dev.off()
plot(boundaries, ylim = c(38.79323, 38.99526), xlim = c(-77.11664, -76.90953))
plot(streets, col = streets$color, ylim = c(38.79323, 38.99526), xlim = c(-77.11664, -76.90953), add = TRUE)
text(x = -76.9, y = 38.95, mymonths[i], cex = 4)
for (i in 1:12){
a = NA
b = NA
c = NA
d = NA
e = NA
df.d = NA
df.streets = data.frame(streets)
streets$color = NA
a = bcs[which(bcs$month == i),]
a$counter = 1
c = aggregate(a$counter ~ a$STREETSEGI, FUN = sum)
c$color = NA
cfunc = colfunc(max(c$`a$counter`))
for(j in 1:nrow(c)){
c$color[j] = cfunc[c$`a$counter`[j]]
}
df.d = data.frame(c$`a$STREETSEGI`, c$color, c$`a$counter`)
colnames(df.d) = c("STREETSEGI", "color", "counts")
df.d = df.d[which(!duplicated(df.d$STREETSEGI)),]
df.d = df.d[1:nrow(df.streets),]
df.d = data.frame(df.d, stringsAsFactors = FALSE)
df.d$color = lapply(df.d$color, function(x) if(is.factor(x)) factor(x) else x)
df.d$color[which(df.d$counts == 1)] = "yellow"
df.d$color[which(df.d$counts == 2)] = "orange"
df.d$color[which(df.d$counts == 3)] = "darkorange"
df.d$color[which(df.d$counts == 4)] = "red"
df.d$color[which(df.d$counts >= 5)] = "darkred"
# gray is deefault no crime color
# df.d$color[which(df.d$color == "1")] = "gray"
streets$color = unlist(df.d$color)
id = i
if(id <= 9){id = paste(0,i, sep = "")}
setwd("C:\\Users\\avanplan\\Documents\\GitHub\\DC-crime-map-R\\gif")
jpeg(paste(id,"DCcrimeRoads.jpg", sep = ""), width = 800, height = 700)
plot(boundaries, ylim = c(38.79323, 38.99526), xlim = c(-77.11664, -76.90953))
plot(streets, col = streets$color, ylim = c(38.79323, 38.99526), xlim = c(-77.11664, -76.90953), add = TRUE)
text(x = -76.9, y = 38.95, mymonths[i], cex = 4)
dev.off()
}
list.files(path = "C:\\Users\\avanplan\\Documents\\GitHub\\DC-crime-map-R\\gif", pattern = "*.jpg", full.names = T) %>%
map(image_read) %>% # reads each path file
image_join() %>% # joins image
image_animate(fps=2) %>% # animates, can opt for number of loops
image_write("dc_crime_roads_months_gif.gif") # write to current dir
bcs$STREETSEGI
streets$STREETSEGI
?order
bcs[order(streets$STREETSEGI)]
bcs[order(STREETSEGI, streets$STREETSEGI)]
View(bcs)
bcs[which(is.na(bcs$STREETSEGI)),]
bcs[which(bcs$BLOCK == "1 - 1299 BLOCK OF BLAGDEN ALLEY NW"),]
x = bcs[which(bcs$BLOCK == "1 - 1299 BLOCK OF BLAGDEN ALLEY NW"),]
x$color
x$STREETSEGI
View(x)
x = bcs[which(bcs$BLOCKNAME == "1 - 1299 BLOCK OF BLAGDEN ALLEY NW"),]
streets$STREETSEGI
streets$STREETID
df.blocks$ONSTREETID
a = NA
b = NA
c = NA
d = NA
e = NA
df.d = NA
df.streets = data.frame(streets)
streets$color = NA
a = bcs[which(bcs$month == i),]
a$counter = 1
c = aggregate(a$counter ~ a$STREETID, FUN = sum)
c$color = NA
cfunc = colfunc(max(c$`a$counter`))
for(j in 1:nrow(c)){
c$color[j] = cfunc[c$`a$counter`[j]]
}
df.d = data.frame(c$`a$STREETSEGI`, c$color, c$`a$counter`)
colnames(df.d) = c("STREETSEGI", "color", "counts")
df.d = df.d[which(!duplicated(df.d$STREETSEGI)),]
df.d = df.d[1:nrow(df.streets),]
df.d = data.frame(df.d, stringsAsFactors = FALSE)
df.d$color = lapply(df.d$color, function(x) if(is.factor(x)) factor(x) else x)
df.d$color[which(df.d$counts == 1)] = "yellow"
df.d$color[which(df.d$counts == 2)] = "orange"
df.d$color[which(df.d$counts == 3)] = "darkorange"
df.d$color[which(df.d$counts == 4)] = "red"
df.d$color[which(df.d$counts >= 5)] = "darkred"
# gray is deefault no crime color
# df.d$color[which(df.d$color == "1")] = "gray"
streets$color = unlist(df.d$color)
id = i
if(id <= 9){id = paste(0,i, sep = "")}
setwd("C:\\Users\\avanplan\\Documents\\GitHub\\DC-crime-map-R\\gif")
jpeg(paste(id,"DCcrimeRoads.jpg", sep = ""), width = 800, height = 700)
plot(boundaries, ylim = c(38.79323, 38.99526), xlim = c(-77.11664, -76.90953))
plot(streets, col = streets$color, ylim = c(38.79323, 38.99526), xlim = c(-77.11664, -76.90953), add = TRUE)
text(x = -76.9, y = 38.95, mymonths[i], cex = 4)
dev.off()
dev.off()
dev.off()
a = bcs[which(bcs$month == i),]
a$counter = 1
c = aggregate(a$counter ~ a$STREETID, FUN = sum)
c$color = NA
cfunc = colfunc(max(c$`a$counter`))
for(j in 1:nrow(c)){
c$color[j] = cfunc[c$`a$counter`[j]]
}
df.d = data.frame(c$`a$STREEID`, c$color, c$`a$counter`)
colnames(df.d) = c("STREETID", "color", "counts")
df.d = data.frame(c$`a$STREETID`, c$color, c$`a$counter`)
colnames(df.d) = c("STREETID", "color", "counts")
df.d = df.d[which(!duplicated(df.d$STREETSEGI)),]
df.d = df.d[1:nrow(df.streets),]
df.d = data.frame(df.d, stringsAsFactors = FALSE)
df.d$color = lapply(df.d$color, function(x) if(is.factor(x)) factor(x) else x)
a = NA
b = NA
c = NA
d = NA
e = NA
df.d = NA
df.streets = data.frame(streets)
streets$color = NA
a = bcs[which(bcs$month == i),]
a$counter = 1
c = aggregate(a$counter ~ a$STREETID, FUN = sum)
c$color = NA
cfunc = colfunc(max(c$`a$counter`))
for(j in 1:nrow(c)){
c$color[j] = cfunc[c$`a$counter`[j]]
}
df.d = data.frame(c$`a$STREETID`, c$color, c$`a$counter`)
colnames(df.d) = c("STREETID", "color", "counts")
df.d = df.d[which(!duplicated(df.d$STREETSEGI)),]
df.d = df.d[1:nrow(df.streets),]
df.d = data.frame(df.d, stringsAsFactors = FALSE)
df.d$color = lapply(df.d$color, function(x) if(is.factor(x)) factor(x) else x)
df.d$color[which(df.d$counts == 1)] = "yellow"
df.d$color[which(df.d$counts == 2)] = "orange"
df.d$color[which(df.d$counts == 3)] = "darkorange"
df.d$color[which(df.d$counts == 4)] = "red"
df.d$color[which(df.d$counts >= 5)] = "darkred"
# gray is deefault no crime color
# df.d$color[which(df.d$color == "1")] = "gray"
streets$color = unlist(df.d$color)
id = i
if(id <= 9){id = paste(0,i, sep = "")}
setwd("C:\\Users\\avanplan\\Documents\\GitHub\\DC-crime-map-R\\gif")
jpeg(paste(id,"DCcrimeRoads.jpg", sep = ""), width = 800, height = 700)
plot(boundaries, ylim = c(38.79323, 38.99526), xlim = c(-77.11664, -76.90953))
plot(streets, col = streets$color, ylim = c(38.79323, 38.99526), xlim = c(-77.11664, -76.90953), add = TRUE)
text(x = -76.9, y = 38.95, mymonths[i], cex = 4)
dev.off()
streets$color
df.d$color
a = NA
b = NA
c = NA
d = NA
e = NA
df.d = NA
df.streets = data.frame(streets)
streets$color = NA
a = bcs[which(bcs$month == i),]
a$counter = 1
c = aggregate(a$counter ~ a$STREETID, FUN = sum)
c
c$color = NA
cfunc = colfunc(max(c$`a$counter`))
for(j in 1:nrow(c)){
c$color[j] = cfunc[c$`a$counter`[j]]
}
c$color
cfunc = colfunc(max(c$`a$counter`))
for(j in 1:nrow(c)){
c$color[j] = cfunc[c$`a$counter`[j]]
}
df.d = data.frame(c$`a$STREETID`, c$color, c$`a$counter`)
colnames(df.d) = c("STREETID", "color", "counts")
df.d$color
df.d = df.d[which(!duplicated(df.d$STREETSEGI)),]
df.d = df.d[1:nrow(df.streets),]
df.d = data.frame(df.d, stringsAsFactors = FALSE)
df.d$color = lapply(df.d$color, function(x) if(is.factor(x)) factor(x) else x)
df.d$color[which(df.d$counts == 1)] = "yellow"
df.d$color[which(df.d$counts == 2)] = "orange"
df.d$color[which(df.d$counts == 3)] = "darkorange"
df.d$color[which(df.d$counts == 4)] = "red"
df.d$color[which(df.d$counts >= 5)] = "darkred"
df.d$color
df.d = data.frame(c$`a$STREETID`, c$color, c$`a$counter`)
colnames(df.d) = c("STREETID", "color", "counts")
df.d$color
df.d = df.d[which(!duplicated(df.d$STREETSEGI)),]
df.d = df.d[1:nrow(df.streets),]
df.d = data.frame(df.d, stringsAsFactors = FALSE)
df.d$color[which(df.d$counts == 1)] = "yellow"
df.d$color[which(df.d$counts == 2)] = "orange"
a = NA
b = NA
c = NA
d = NA
e = NA
df.d = NA
df.streets = data.frame(streets)
streets$color = NA
a = bcs[which(bcs$month == i),]
a$counter = 1
c = aggregate(a$counter ~ a$STREETID, FUN = sum)
c$color = NA
# cfunc = colfunc(max(c$`a$counter`))
#   for(j in 1:nrow(c)){
#     c$color[j] = cfunc[c$`a$counter`[j]]
#   }
df.d = data.frame(c$`a$STREETID`, c$color, c$`a$counter`)
colnames(df.d) = c("STREETID", "color", "counts")
df.d = df.d[which(!duplicated(df.d$STREETSEGI)),]
df.d = df.d[1:nrow(df.streets),]
df.d = data.frame(df.d, stringsAsFactors = FALSE)
#df.d$color = lapply(df.d$color, function(x) if(is.factor(x)) factor(x) else x)
df.d$color[which(df.d$counts == 1)] = "yellow"
df.d$color[which(df.d$counts == 2)] = "orange"
df.d$color[which(df.d$counts == 3)] = "darkorange"
df.d$color[which(df.d$counts == 4)] = "red"
df.d$color[which(df.d$counts >= 5)] = "darkred"
streets$color = unlist(df.d$color)
id = i
if(id <= 9){id = paste(0,i, sep = "")}
setwd("C:\\Users\\avanplan\\Documents\\GitHub\\DC-crime-map-R\\gif")
jpeg(paste(id,"DCcrimeRoads.jpg", sep = ""), width = 800, height = 700)
plot(boundaries, ylim = c(38.79323, 38.99526), xlim = c(-77.11664, -76.90953))
plot(streets, col = streets$color, ylim = c(38.79323, 38.99526), xlim = c(-77.11664, -76.90953), add = TRUE)
text(x = -76.9, y = 38.95, mymonths[i], cex = 4)
dev.off()
df.d$color
a = NA
b = NA
c = NA
d = NA
e = NA
df.d = NA
df.streets = data.frame(streets)
streets$color = NA
a$counter = 1
a = bcs[which(bcs$month == i),]
c = aggregate(a$counter ~ a$STREETID, FUN = sum)
c$color = NA
a = NA
b = NA
c = NA
d = NA
e = NA
df.d = NA
df.streets = data.frame(streets)
streets$color = NA
a = bcs[which(bcs$month == i),]
a$counter = 1
c = aggregate(a$counter ~ a$STREETID, FUN = sum)
c$color = NA
df.d = data.frame(c$`a$STREETID`, c$color, c$`a$counter`)
colnames(df.d) = c("STREETID", "color", "counts")
df.d = df.d[which(!duplicated(df.d$STREETSEGI)),]
df.d = df.d[1:nrow(df.streets),]
df.d = data.frame(df.d, stringsAsFactors = FALSE)
df.d$color[which(df.d$counts == 1)] = "yellow"
df.d$color[which(df.d$counts == 2)] = "orange"
df.d$color[which(df.d$counts == 3)] = "darkorange"
df.d$color[which(df.d$counts == 4)] = "red"
df.d$color[which(df.d$counts >= 5)] = "darkred"
df.d$color
df.d = data.frame(c$`a$STREETID`, c$color, c$`a$counter`)
colnames(df.d) = c("STREETID", "color", "counts")
df.d = df.d[which(!duplicated(df.d$STREETSEGI)),]
a = NA
b = NA
c = NA
d = NA
e = NA
df.d = NA
df.streets = data.frame(streets)
streets$color = NA
a = bcs[which(bcs$month == i),]
a$counter = 1
c = aggregate(a$counter ~ a$STREETID, FUN = sum)
c$color = NA
# cfunc = colfunc(max(c$`a$counter`))
#   for(j in 1:nrow(c)){
#     c$color[j] = cfunc[c$`a$counter`[j]]
#   }
df.d = data.frame(c$`a$STREETID`, c$color, c$`a$counter`)
colnames(df.d) = c("STREETID", "color", "counts")
#df.d = df.d[which(!duplicated(df.d$STREETSEGI)),]
#df.d = df.d[1:nrow(df.streets),]
#df.d = data.frame(df.d, stringsAsFactors = FALSE)
#df.d$color = lapply(df.d$color, function(x) if(is.factor(x)) factor(x) else x)
df.d$color[which(df.d$counts == 1)] = "yellow"
df.d$color[which(df.d$counts == 2)] = "orange"
df.d$color[which(df.d$counts == 3)] = "darkorange"
df.d$color[which(df.d$counts == 4)] = "red"
df.d$color[which(df.d$counts >= 5)] = "darkred"
df.d$color
df.d$STREETID
streets$STREETID
streets$ROADWAYSEG
streets$OBJECTID
df.d[order(streets$STREETID)]
df.d[order(streets$STREETID)]
df.d$STREETID[order(streets$STREETID)]
df.crimes$OBJECTID
bcs$OBJECTID.y
bcs$OBJECTID_1
bcs$OBJECTID.x
a = NA
b = NA
c = NA
d = NA
e = NA
df.d = NA
df.streets = data.frame(streets)
streets$color = NA
a = bcs[which(bcs$month == i),]
a$counter = 1
c = aggregate(a$counter ~ a$OBJECTID.y, FUN = sum)
c$color = NA
df.d = data.frame(c$`a$OBJECTID.y`, c$color, c$`a$counter`)
colnames(df.d) = c("OBJECTID", "color", "counts")
df.d$color[which(df.d$counts == 1)] = "yellow"
df.d$color[which(df.d$counts == 2)] = "orange"
df.d$color[which(df.d$counts == 3)] = "darkorange"
df.d$color[which(df.d$counts == 4)] = "red"
df.d$color[which(df.d$counts >= 5)] = "darkred"
streets$color = unlist(df.d$color)
df.d
df.d$OBJECTID[order(streets$OBJECTID)]
df.d[order(streets$OBJECTID),c(1,2,3)]
df.d[order(streets$OBJECTID),c(1,2,3)][1,]
streets[1,]
df.d$OBJECTID[order(streets$OBJECTID)][1,]
df.d$OBJECTID[order(streets$OBJECTID)][1]
streets[1,]
set.seed(0)
a = sample(1:20,replace=F)
b = sample(1:20,replace=F)
f = as.factor(letters[1:20])
fn = factor(f, levels=unique(f[order(a,b,f)]), ordered=TRUE)
fn
factor(f, levels=unique(f[order(b,a,f)]), ordered=TRUE)
df.d[match(streets$OBJECTID, df.d$OBJECTID)]
df.d[match(streets$OBJECTID, df.d$OBJECTID),]
df.d[match(streets$OBJECTID, df.d$OBJECTID),][1,]
streets$OBJECTID[1]
a = NA
b = NA
c = NA
d = NA
e = NA
df.d = NA
df.streets = data.frame(streets)
streets$color = NA
a = bcs[which(bcs$month == i),]
a$counter = 1
c = aggregate(a$counter ~ a$OBJECTID.y, FUN = sum)
c$color = NA
# cfunc = colfunc(max(c$`a$counter`))
#   for(j in 1:nrow(c)){
#     c$color[j] = cfunc[c$`a$counter`[j]]
#   }
df.d = data.frame(c$`a$OBJECTID.y`, c$color, c$`a$counter`)
colnames(df.d) = c("OBJECTID", "color", "counts")
#df.d = df.d[which(!duplicated(df.d$STREETSEGI)),]
#df.d = df.d[1:nrow(df.streets),]
#df.d = data.frame(df.d, stringsAsFactors = FALSE)
#df.d$color = lapply(df.d$color, function(x) if(is.factor(x)) factor(x) else x)
df.d$color[which(df.d$counts == 1)] = "yellow"
df.d$color[which(df.d$counts == 2)] = "orange"
df.d$color[which(df.d$counts == 3)] = "darkorange"
df.d$color[which(df.d$counts == 4)] = "red"
df.d$color[which(df.d$counts >= 5)] = "darkred"
# gray is deefault no crime color
# df.d$color[which(df.d$color == "1")] = "gray"
streets$color = unlist(df.d$color)
id = i
if(id <= 9){id = paste(0,i, sep = "")}
df.d = data.frame(c$`a$OBJECTID.y`, c$color, c$`a$counter`)
colnames(df.d) = c("OBJECTID", "color", "counts")
df.d$color[which(df.d$counts == 1)] = "yellow"
df.d$color[which(df.d$counts == 2)] = "orange"
df.d$color[which(df.d$counts == 3)] = "darkorange"
df.d$color[which(df.d$counts == 4)] = "red"
df.d$color[which(df.d$counts >= 5)] = "darkred"
streets$color = unlist(df.d$color)
id = i
df.d$color
nrow(df.d)
nrow(df.streets)
a = NA
b = NA
c = NA
d = NA
e = NA
df.d = NA
df.streets = data.frame(streets)
streets$color = NA
a = bcs[which(bcs$month == i),]
a$counter = 1
c = aggregate(a$counter ~ a$OBJECTID.y, FUN = sum)
c$color = NA
# cfunc = colfunc(max(c$`a$counter`))
#   for(j in 1:nrow(c)){
#     c$color[j] = cfunc[c$`a$counter`[j]]
#   }
df.d = data.frame(c$`a$OBJECTID.y`, c$color, c$`a$counter`)
colnames(df.d) = c("OBJECTID", "color", "counts")
#df.d = df.d[which(!duplicated(df.d$STREETSEGI)),]
#df.d = df.d[1:nrow(df.streets),]
#df.d = data.frame(df.d, stringsAsFactors = FALSE)
#df.d$color = lapply(df.d$color, function(x) if(is.factor(x)) factor(x) else x)
df.d$color[which(df.d$counts == 1)] = "yellow"
df.d$color[which(df.d$counts == 2)] = "orange"
df.d$color[which(df.d$counts == 3)] = "darkorange"
df.d$color[which(df.d$counts == 4)] = "red"
df.d$color[which(df.d$counts >= 5)] = "darkred"
nrow(df.d)
bcs$OBJECTID.y
lenth(df.streets$OBJECTID)
length(df.streets$OBJECTID)
length(unique(df.streets$OBJECTID))
length(!duplicated(df.streets$OBJECTID))
!duplicated(df.streets$OBJECTID)
unique(df.streets$OBJECTID)
unique(bcs$OBJECTID.y)
length(unique(bcs$OBJECTID.y))
length(unique(bcs$STREETSEGI))
length(unique(streets$OBJECTID))
?lookup
?lookup
?%l%
?Lookup
streets[order(streets$OBJECTID)]
streets[order(streets$OBJECTID),]
nrow(bcs)
length(unique(df.streets$OBJECTID))
length(unique(df.bcs$OBJECTID.y))
length(unique(bcs$OBJECTID.y))
a = NA
b = NA
c = NA
d = NA
e = NA
df.d = NA
df.streets = data.frame(streets)
streets$color = NA
a = df.crimes[which(df.crimes$month == i),]
b = merge(a, df.blocks, "BLOCK")
b$counter = 1
c = aggregate(b$counter ~ b$BLOCK, FUN = sum)
c$color = NA
cfunc = colfunc(max(c$`b$counter`))
for(j in 1:nrow(c)){
c$color[j] = cfunc[c$`b$counter`[j]]
}
c$BLOCK = c$`b$BLOCK`
#c$STREETSEGI = NA
d = merge(c, df.blocks, "BLOCK")
df.d = data.frame(d$STREETSEGI, d$color, d$`b$counter`)
colnames(df.d) = c("STREETSEGI", "color", "counts")
df.d = df.d[which(!duplicated(df.d$STREETSEGI)),]
df.d = merge(df.streets, df.d, "STREETSEGI", all = T)
df.d = df.d[1:nrow(df.streets),]
df.d = data.frame(df.d, stringsAsFactors = FALSE)
df.d$color.y = lapply(df.d$color.y, function(x) if(is.factor(x)) factor(x) else x)
df.d$color.y[which(df.d$counts == 1)] = "yellow"
df.d$color.y[which(df.d$counts == 2)] = "orange"
df.d$color.y[which(df.d$counts == 3)] = "darkorange"
df.streets$color = as.character(df.d$color.y)
df.streets$color[which(df.streets$color == "NA")] = "gray"
# make default no crime color
df.streets$STREETSEGI[1]
streets$STREETSEGI[1]
df.streets$STREETSEGI[2]
df.streets$STREETSEGI[3]
df.streets$STREETSEGI[4]
streets$STREETSEGI[4]
streets$STREETSEGI[5000]
df.streets$STREETSEGI[5000]
df.d$counts
